# Codex å¼€å‘å·¥ä½œæµè§„èŒƒ

**é¡¹ç›®**: K8Sé›†ç¾¤ç®¡ç†å¹³å°  
**ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-11-11  
**é€‚ç”¨ç¯å¢ƒ**: openEuler + Docker + Codex

---

## ç›®å½•

1. [å·¥ä½œæµæ¦‚è§ˆ](#1-å·¥ä½œæµæ¦‚è§ˆ)
2. [å¼€å‘ç¯å¢ƒå‡†å¤‡](#2-å¼€å‘ç¯å¢ƒå‡†å¤‡)
3. [éœ€æ±‚æ¥æ”¶ä¸åˆ†æ](#3-éœ€æ±‚æ¥æ”¶ä¸åˆ†æ)
4. [å¼€å‘æµç¨‹](#4-å¼€å‘æµç¨‹)
5. [ä»£ç è§„èŒƒ](#5-ä»£ç è§„èŒƒ)
6. [æµ‹è¯•æµç¨‹](#6-æµ‹è¯•æµç¨‹)
7. [æäº¤è§„èŒƒ](#7-æäº¤è§„èŒƒ)
8. [é—®é¢˜å¤„ç†](#8-é—®é¢˜å¤„ç†)
9. [æœ€ä½³å®è·µ](#9-æœ€ä½³å®è·µ)
10. [æ£€æŸ¥æ¸…å•](#10-æ£€æŸ¥æ¸…å•)

---

## 1. å·¥ä½œæµæ¦‚è§ˆ

### 1.1 å®Œæ•´å¼€å‘æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Codex å¼€å‘å·¥ä½œæµ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬1æ­¥: éœ€æ±‚æ¥æ”¶
  â†“
  ç”¨æˆ·æè¿°éœ€æ±‚ â†’ Codexç†è§£éœ€æ±‚ â†’ ç¡®è®¤éœ€æ±‚ç»†èŠ‚
  â†“
  
ç¬¬2æ­¥: æŠ€æœ¯è®¾è®¡
  â†“
  åˆ†ææŠ€æœ¯æ–¹æ¡ˆ â†’ ç¡®å®šå®ç°è·¯å¾„ â†’ è¯„ä¼°å·¥ä½œé‡
  â†“
  
ç¬¬3æ­¥: ç¯å¢ƒå‡†å¤‡
  â†“
  å¯åŠ¨æµ‹è¯•ç¯å¢ƒ â†’ æ£€æŸ¥ä¾èµ– â†’ å‡†å¤‡æ•°æ®
  â†“
  
ç¬¬4æ­¥: ç¼–å†™ä»£ç 
  â†“
  åç«¯å¼€å‘ â†’ å‰ç«¯å¼€å‘ â†’ é›†æˆè”è°ƒ
  â†“
  
ç¬¬5æ­¥: è‡ªæµ‹éªŒè¯
  â†“
  å•å…ƒæµ‹è¯• â†’ åŠŸèƒ½æµ‹è¯• â†’ è¾¹ç•Œæµ‹è¯•
  â†“
  
ç¬¬6æ­¥: ä»£ç å®¡æŸ¥
  â†“
  ä»£ç è§„èŒƒ â†’ æ€§èƒ½æ£€æŸ¥ â†’ å®‰å…¨æ£€æŸ¥
  â†“
  
ç¬¬7æ­¥: æäº¤äº¤ä»˜
  â†“
  æ•´ç†ä»£ç  â†’ ç¼–å†™æ–‡æ¡£ â†’ æä¾›ç»™ç”¨æˆ·
  â†“
  
ç¬¬8æ­¥: ç”¨æˆ·éªŒæ”¶
  â†“
  ç”¨æˆ·æµ‹è¯• â†’ æ”¶é›†åé¦ˆ â†’ é—®é¢˜ä¿®å¤
  â†“
  
å®Œæˆ âœ“
```

### 1.2 æ—¶é—´åˆ†é…å»ºè®®

**å°åŠŸèƒ½ï¼ˆ<2å°æ—¶ï¼‰**:
- éœ€æ±‚åˆ†æ: 10%
- æŠ€æœ¯è®¾è®¡: 10%
- ç¼–å†™ä»£ç : 50%
- æµ‹è¯•éªŒè¯: 20%
- æ–‡æ¡£æ•´ç†: 10%

**ä¸­ç­‰åŠŸèƒ½ï¼ˆ2-8å°æ—¶ï¼‰**:
- éœ€æ±‚åˆ†æ: 15%
- æŠ€æœ¯è®¾è®¡: 15%
- ç¼–å†™ä»£ç : 40%
- æµ‹è¯•éªŒè¯: 20%
- æ–‡æ¡£æ•´ç†: 10%

**å¤§åŠŸèƒ½ï¼ˆ>8å°æ—¶ï¼‰**:
- éœ€æ±‚åˆ†æ: 20%
- æŠ€æœ¯è®¾è®¡: 20%
- ç¼–å†™ä»£ç : 35%
- æµ‹è¯•éªŒè¯: 15%
- æ–‡æ¡£æ•´ç†: 10%

---

## 2. å¼€å‘ç¯å¢ƒå‡†å¤‡

### 2.1 ç¯å¢ƒæ£€æŸ¥æ¸…å•

**æ¯æ¬¡å¼€å‘å‰å¿…é¡»æ£€æŸ¥**:

```bash
#!/bin/bash
# check-env.sh - ç¯å¢ƒæ£€æŸ¥è„šæœ¬

echo "ğŸ” å¼€å§‹ç¯å¢ƒæ£€æŸ¥..."
echo ""

# 1. æ£€æŸ¥DockeræœåŠ¡
echo "1ï¸âƒ£ æ£€æŸ¥DockeræœåŠ¡..."
if ! docker info > /dev/null 2>&1; then
    echo "âŒ Dockeræœªè¿è¡Œï¼Œè¯·æ‰§è¡Œ: sudo systemctl start docker"
    exit 1
fi
echo "âœ… DockeræœåŠ¡æ­£å¸¸"

# 2. æ£€æŸ¥æµ‹è¯•ç¯å¢ƒå®¹å™¨
echo ""
echo "2ï¸âƒ£ æ£€æŸ¥æµ‹è¯•å®¹å™¨..."
if ! docker ps | grep -q "k8s-mgr-mysql-test"; then
    echo "âš ï¸  MySQLæµ‹è¯•å®¹å™¨æœªè¿è¡Œï¼Œæ˜¯å¦å¯åŠ¨? (y/n)"
    read -r answer
    if [ "$answer" = "y" ]; then
        cd ~/k8s-manager
        ./test-env-start.sh
    fi
else
    echo "âœ… MySQLæµ‹è¯•å®¹å™¨è¿è¡Œä¸­"
fi

if ! docker ps | grep -q "k8s-mgr-redis-test"; then
    echo "âš ï¸  Redisæµ‹è¯•å®¹å™¨æœªè¿è¡Œ"
else
    echo "âœ… Redisæµ‹è¯•å®¹å™¨è¿è¡Œä¸­"
fi

# 3. æ£€æŸ¥é¡¹ç›®ç›®å½•
echo ""
echo "3ï¸âƒ£ æ£€æŸ¥é¡¹ç›®ç›®å½•..."
if [ ! -d ~/k8s-manager ]; then
    echo "âŒ é¡¹ç›®ç›®å½•ä¸å­˜åœ¨"
    exit 1
fi
echo "âœ… é¡¹ç›®ç›®å½•å­˜åœ¨"

# 4. æ£€æŸ¥Goç¯å¢ƒ
echo ""
echo "4ï¸âƒ£ æ£€æŸ¥Goç¯å¢ƒ..."
if ! command -v go &> /dev/null; then
    echo "âŒ Goæœªå®‰è£…"
    exit 1
fi
echo "âœ… Goç‰ˆæœ¬: $(go version)"

# 5. æ£€æŸ¥Nodeç¯å¢ƒ
echo ""
echo "5ï¸âƒ£ æ£€æŸ¥Nodeç¯å¢ƒ..."
if ! command -v node &> /dev/null; then
    echo "âš ï¸  Node.jsæœªå®‰è£…ï¼ˆå‰ç«¯å¼€å‘éœ€è¦ï¼‰"
else
    echo "âœ… Nodeç‰ˆæœ¬: $(node --version)"
fi

# 6. æ£€æŸ¥æ•°æ®åº“è¿æ¥
echo ""
echo "6ï¸âƒ£ æ£€æŸ¥æ•°æ®åº“è¿æ¥..."
if docker exec k8s-mgr-mysql-test mysql -uroot -ptest123456 -e "SELECT 1" > /dev/null 2>&1; then
    echo "âœ… MySQLè¿æ¥æ­£å¸¸"
else
    echo "âŒ MySQLè¿æ¥å¤±è´¥"
    exit 1
fi

# 7. æ£€æŸ¥ç£ç›˜ç©ºé—´
echo ""
echo "7ï¸âƒ£ æ£€æŸ¥ç£ç›˜ç©ºé—´..."
disk_usage=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ "$disk_usage" -gt 80 ]; then
    echo "âš ï¸  ç£ç›˜ä½¿ç”¨ç‡: ${disk_usage}%ï¼ˆå»ºè®®æ¸…ç†ï¼‰"
else
    echo "âœ… ç£ç›˜ä½¿ç”¨ç‡: ${disk_usage}%"
fi

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… ç¯å¢ƒæ£€æŸ¥å®Œæˆï¼Œå¯ä»¥å¼€å§‹å¼€å‘ï¼"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

**ä½¿ç”¨æ–¹å¼**:
```bash
# ä¿å­˜è„šæœ¬
vim ~/k8s-manager/check-env.sh
# ç²˜è´´ä¸Šé¢çš„å†…å®¹

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x ~/k8s-manager/check-env.sh

# æ¯æ¬¡å¼€å‘å‰æ‰§è¡Œ
cd ~/k8s-manager
./check-env.sh
```

### 2.2 å·¥ä½œåŒºå‡†å¤‡

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/k8s-manager

# 2. å¯åŠ¨æµ‹è¯•ç¯å¢ƒï¼ˆå¦‚æœæœªå¯åŠ¨ï¼‰
./test-env-start.sh

# 3. åˆ›å»ºä»Šæ—¥å·¥ä½œåˆ†æ”¯ï¼ˆå¯é€‰ï¼‰
cd backend
git checkout -b feature/$(date +%Y%m%d)-é›†ç¾¤ç®¡ç†

# 4. å‡†å¤‡å·¥ä½œæ—¥å¿—
echo "## $(date +%Y-%m-%d) å¼€å‘æ—¥å¿—" >> ~/k8s-manager/dev-log.md
echo "" >> ~/k8s-manager/dev-log.md
```

---

## 3. éœ€æ±‚æ¥æ”¶ä¸åˆ†æ

### 3.1 éœ€æ±‚ç¡®è®¤æ¨¡æ¿

**Codexåœ¨æ”¶åˆ°éœ€æ±‚åï¼Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ç¡®è®¤**:

```markdown
## éœ€æ±‚ç¡®è®¤

### ğŸ“‹ éœ€æ±‚æè¿°
[ç”¨æˆ·çš„åŸå§‹éœ€æ±‚]

### ğŸ¯ ç›®æ ‡
[æ˜ç¡®çš„å¼€å‘ç›®æ ‡]

### ğŸ“¦ äº¤ä»˜ç‰©
- [ ] åç«¯APIæ¥å£
- [ ] å‰ç«¯é¡µé¢/ç»„ä»¶
- [ ] æ•°æ®åº“è¡¨ç»“æ„
- [ ] æ¥å£æ–‡æ¡£
- [ ] æµ‹è¯•ç”¨ä¾‹

### ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ
[ç®€è¦çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆ]

### â±ï¸ é¢„è®¡å·¥ä½œé‡
- åç«¯å¼€å‘: Xå°æ—¶
- å‰ç«¯å¼€å‘: Xå°æ—¶
- æµ‹è¯•éªŒè¯: Xå°æ—¶
- æ€»è®¡: Xå°æ—¶

### â“ å¾…ç¡®è®¤é—®é¢˜
1. [é—®é¢˜1]
2. [é—®é¢˜2]

### âœ… ç¡®è®¤ä¿¡æ¯
è¯·ç¡®è®¤ä»¥ä¸Šç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿæ˜¯å¦æœ‰è¡¥å……æˆ–ä¿®æ”¹ï¼Ÿ
```

### 3.2 éœ€æ±‚åˆ†æç¤ºä¾‹

**ç¤ºä¾‹1: ç®€å•åŠŸèƒ½**

```
ç”¨æˆ·éœ€æ±‚: "å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½"

Codexç¡®è®¤:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ éœ€æ±‚æè¿°
å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼Œç”¨æˆ·ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•ç³»ç»Ÿ

ğŸ¯ ç›®æ ‡
1. ç”¨æˆ·å¯ä»¥é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•
2. ç™»å½•æˆåŠŸè¿”å›JWT token
3. tokenæœ‰æ•ˆæœŸ2å°æ—¶

ğŸ“¦ äº¤ä»˜ç‰©
- [x] åç«¯ç™»å½•API
- [x] JWT tokenç”Ÿæˆå’ŒéªŒè¯
- [x] å‰ç«¯ç™»å½•é¡µé¢
- [x] ç™»å½•çŠ¶æ€ç®¡ç†
- [x] APIæ–‡æ¡£

ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ
åç«¯:
- ä½¿ç”¨bcryptéªŒè¯å¯†ç 
- ä½¿ç”¨JWTç”Ÿæˆtoken
- å®ç°ç™»å½•API: POST /api/v1/auth/login

å‰ç«¯:
- ä½¿ç”¨Ant Design Formç»„ä»¶
- ç™»å½•æˆåŠŸåä¿å­˜tokenåˆ°localStorage
- è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ

â±ï¸ é¢„è®¡å·¥ä½œé‡
- åç«¯å¼€å‘: 1å°æ—¶
- å‰ç«¯å¼€å‘: 1.5å°æ—¶
- æµ‹è¯•éªŒè¯: 0.5å°æ—¶
- æ€»è®¡: 3å°æ—¶

â“ å¾…ç¡®è®¤é—®é¢˜
1. æ˜¯å¦éœ€è¦è®°ä½å¯†ç åŠŸèƒ½ï¼Ÿ
2. æ˜¯å¦éœ€è¦éªŒè¯ç ï¼Ÿ
3. ç™»å½•å¤±è´¥æ˜¯å¦æœ‰æ¬¡æ•°é™åˆ¶ï¼Ÿ

âœ… è¯·ç¡®è®¤æ˜¯å¦å¯ä»¥å¼€å§‹å¼€å‘ï¼Ÿ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**ç¤ºä¾‹2: å¤æ‚åŠŸèƒ½**

```
ç”¨æˆ·éœ€æ±‚: "å®ç°Deploymentç®¡ç†åŠŸèƒ½"

Codexç¡®è®¤:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ éœ€æ±‚æè¿°
å®ç°Kubernetes Deploymentçš„å®Œæ•´ç®¡ç†åŠŸèƒ½

ğŸ¯ ç›®æ ‡
1. æŸ¥çœ‹Deploymentåˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰
2. æŸ¥çœ‹Deploymentè¯¦æƒ…
3. åˆ›å»ºæ–°çš„Deployment
4. æ›´æ–°Deploymenté…ç½®
5. åˆ é™¤Deployment
6. æ‰©ç¼©å®¹æ“ä½œ
7. é‡å¯Deployment

ğŸ“¦ äº¤ä»˜ç‰©
- [x] åç«¯APIï¼ˆ7ä¸ªæ¥å£ï¼‰
- [x] client-goå°è£…
- [x] å‰ç«¯åˆ—è¡¨é¡µé¢
- [x] å‰ç«¯è¯¦æƒ…é¡µé¢
- [x] å‰ç«¯åˆ›å»º/ç¼–è¾‘è¡¨å•
- [x] APIæ–‡æ¡£
- [x] æµ‹è¯•ç”¨ä¾‹

ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ
åç«¯:
1. å°è£…client-goæ“ä½œDeploymentçš„æ–¹æ³•
2. å®ç°7ä¸ªRESTful API
3. æ”¯æŒYAMLå’Œè¡¨å•ä¸¤ç§åˆ›å»ºæ–¹å¼
4. æ·»åŠ æ“ä½œå®¡è®¡æ—¥å¿—

å‰ç«¯:
1. åˆ—è¡¨é¡µ: Ant Design Table + æœç´¢/ç­›é€‰
2. è¯¦æƒ…é¡µ: Tabé¡µï¼ˆåŸºæœ¬ä¿¡æ¯/Pods/Events/YAMLï¼‰
3. åˆ›å»ºé¡µ: è¡¨å•æ¨¡å¼ + YAMLç¼–è¾‘å™¨åˆ‡æ¢
4. æ“ä½œç¡®è®¤: ModaläºŒæ¬¡ç¡®è®¤

æ•°æ®åº“:
- æ— éœ€æ–°å»ºè¡¨ï¼ˆK8Sæ•°æ®å­˜å‚¨åœ¨etcdï¼‰
- å®¡è®¡æ—¥å¿—è¡¨å·²å­˜åœ¨

â±ï¸ é¢„è®¡å·¥ä½œé‡
- åç«¯å¼€å‘: 4å°æ—¶
- å‰ç«¯å¼€å‘: 6å°æ—¶
- æµ‹è¯•éªŒè¯: 2å°æ—¶
- æ€»è®¡: 12å°æ—¶

å»ºè®®åˆ†3æ¬¡å®Œæˆ:
ç¬¬1æ¬¡: åˆ—è¡¨æŸ¥è¯¢ + è¯¦æƒ…æŸ¥çœ‹ï¼ˆ4hï¼‰
ç¬¬2æ¬¡: åˆ›å»º + æ›´æ–° + åˆ é™¤ï¼ˆ4hï¼‰
ç¬¬3æ¬¡: æ‰©ç¼©å®¹ + é‡å¯ + ä¼˜åŒ–ï¼ˆ4hï¼‰

â“ å¾…ç¡®è®¤é—®é¢˜
1. æ˜¯å¦æ”¯æŒæ‰¹é‡æ“ä½œï¼Ÿ
2. YAMLç¼–è¾‘å™¨ä½¿ç”¨Monacoè¿˜æ˜¯ç®€å•çš„textareaï¼Ÿ
3. æ˜¯å¦éœ€è¦Deploymentæ¨¡æ¿åŠŸèƒ½ï¼Ÿ

âœ… è¯·ç¡®è®¤æ–¹æ¡ˆï¼Œæˆ‘å°†å¼€å§‹ç¬¬ä¸€é˜¶æ®µå¼€å‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## 4. å¼€å‘æµç¨‹

### 4.1 åç«¯å¼€å‘æ ‡å‡†æµç¨‹

#### Step 1: é˜…è¯»æŠ€èƒ½æ–‡æ¡£ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
# å¦‚æœæ¶‰åŠç‰¹å®šæŠ€æœ¯ï¼Œå…ˆé˜…è¯»æŠ€èƒ½æ–‡æ¡£
# ä¾‹å¦‚: æ“ä½œExcelæ–‡ä»¶
cat /mnt/skills/public/xlsx/SKILL.md

# æˆ–è€…: åˆ›å»ºWordæ–‡æ¡£
cat /mnt/skills/public/docx/SKILL.md
```

#### Step 2: åˆ›å»ºç›®å½•ç»“æ„

```bash
# ç¤ºä¾‹: åˆ›å»ºé›†ç¾¤ç®¡ç†æ¨¡å—
mkdir -p ~/k8s-manager/backend/internal/api/v1/cluster
mkdir -p ~/k8s-manager/backend/internal/service
mkdir -p ~/k8s-manager/backend/internal/k8s
```

#### Step 3: ç¼–å†™ä»£ç ï¼ˆè‡ªåº•å‘ä¸Šï¼‰

**é¡ºåº**: æ•°æ®æ¨¡å‹ â†’ K8Sæ“ä½œ â†’ Serviceå±‚ â†’ APIå±‚ â†’ è·¯ç”±

**1. æ•°æ®æ¨¡å‹** (`internal/model/cluster.go`):
```go
package model

import "time"

type Cluster struct {
    ID          uint      `gorm:"primaryKey" json:"id"`
    Name        string    `gorm:"uniqueIndex;size:100;not null" json:"name"`
    Kubeconfig  string    `gorm:"type:text;not null" json:"-"` // ä¸è¿”å›ç»™å‰ç«¯
    APIServer   string    `gorm:"size:255" json:"api_server"`
    Version     string    `gorm:"size:50" json:"version"`
    Status      int       `gorm:"default:1" json:"status"` // 1-æ­£å¸¸ 0-å¼‚å¸¸
    Description string    `gorm:"size:500" json:"description"`
    CreatedAt   time.Time `json:"created_at"`
    UpdatedAt   time.Time `json:"updated_at"`
}
```

**2. K8Sæ“ä½œå°è£…** (`internal/k8s/client_manager.go`):
```go
package k8s

import (
    "sync"
    "k8s.io/client-go/kubernetes"
    "k8s.io/client-go/tools/clientcmd"
)

type ClusterManager struct {
    clients sync.Map // map[string]*kubernetes.Clientset
}

var Manager = &ClusterManager{}

func (cm *ClusterManager) AddCluster(name, kubeconfig string) error {
    config, err := clientcmd.RESTConfigFromKubeConfig([]byte(kubeconfig))
    if err != nil {
        return err
    }
    
    clientset, err := kubernetes.NewForConfig(config)
    if err != nil {
        return err
    }
    
    cm.clients.Store(name, clientset)
    return nil
}

func (cm *ClusterManager) GetClient(name string) (*kubernetes.Clientset, error) {
    client, ok := cm.clients.Load(name)
    if !ok {
        return nil, errors.New("cluster not found")
    }
    return client.(*kubernetes.Clientset), nil
}
```

**3. Serviceå±‚** (`internal/service/cluster_service.go`):
```go
package service

import (
    "k8s-manager-backend/internal/model"
    "k8s-manager-backend/internal/k8s"
    "k8s-manager-backend/internal/database"
)

type ClusterService struct{}

func NewClusterService() *ClusterService {
    return &ClusterService{}
}

// åˆ›å»ºé›†ç¾¤
func (s *ClusterService) Create(cluster *model.Cluster) error {
    // 1. æµ‹è¯•è¿æ¥
    if err := k8s.Manager.AddCluster(cluster.Name, cluster.Kubeconfig); err != nil {
        return err
    }
    
    // 2. åŠ å¯†kubeconfig
    encryptedConfig, err := encrypt.AESEncrypt(cluster.Kubeconfig)
    if err != nil {
        return err
    }
    cluster.Kubeconfig = encryptedConfig
    
    // 3. ä¿å­˜åˆ°æ•°æ®åº“
    if err := database.DB.Create(cluster).Error; err != nil {
        return err
    }
    
    return nil
}

// è·å–åˆ—è¡¨
func (s *ClusterService) List(page, pageSize int) ([]model.Cluster, int64, error) {
    var clusters []model.Cluster
    var total int64
    
    offset := (page - 1) * pageSize
    
    if err := database.DB.Model(&model.Cluster{}).Count(&total).Error; err != nil {
        return nil, 0, err
    }
    
    if err := database.DB.Offset(offset).Limit(pageSize).Find(&clusters).Error; err != nil {
        return nil, 0, err
    }
    
    return clusters, total, nil
}
```

**4. APIå±‚** (`internal/api/v1/cluster/cluster.go`):
```go
package cluster

import (
    "net/http"
    "strconv"
    "github.com/gin-gonic/gin"
    "k8s-manager-backend/internal/service"
    "k8s-manager-backend/pkg/response"
)

type ClusterHandler struct {
    service *service.ClusterService
}

func NewClusterHandler() *ClusterHandler {
    return &ClusterHandler{
        service: service.NewClusterService(),
    }
}

// åˆ›å»ºé›†ç¾¤
// @Summary åˆ›å»ºé›†ç¾¤
// @Tags é›†ç¾¤ç®¡ç†
// @Accept json
// @Produce json
// @Param cluster body model.Cluster true "é›†ç¾¤ä¿¡æ¯"
// @Success 200 {object} response.Response
// @Router /api/v1/clusters [post]
func (h *ClusterHandler) Create(c *gin.Context) {
    var cluster model.Cluster
    if err := c.ShouldBindJSON(&cluster); err != nil {
        response.Error(c, 40001, "å‚æ•°é”™è¯¯: "+err.Error())
        return
    }
    
    if err := h.service.Create(&cluster); err != nil {
        response.Error(c, 50001, "åˆ›å»ºå¤±è´¥: "+err.Error())
        return
    }
    
    response.Success(c, cluster)
}

// è·å–åˆ—è¡¨
func (h *ClusterHandler) List(c *gin.Context) {
    page, _ := strconv.Atoi(c.DefaultQuery("page", "1"))
    pageSize, _ := strconv.Atoi(c.DefaultQuery("page_size", "20"))
    
    clusters, total, err := h.service.List(page, pageSize)
    if err != nil {
        response.Error(c, 50001, "æŸ¥è¯¢å¤±è´¥: "+err.Error())
        return
    }
    
    response.Success(c, gin.H{
        "total":     total,
        "page":      page,
        "page_size": pageSize,
        "items":     clusters,
    })
}
```

**5. è·¯ç”±æ³¨å†Œ** (`internal/api/router.go`):
```go
package api

import (
    "github.com/gin-gonic/gin"
    "k8s-manager-backend/internal/api/v1/cluster"
    "k8s-manager-backend/internal/middleware"
)

func SetupRouter() *gin.Engine {
    r := gin.Default()
    
    // ä¸­é—´ä»¶
    r.Use(middleware.CORS())
    r.Use(middleware.Logger())
    
    // API v1
    v1 := r.Group("/api/v1")
    {
        // é›†ç¾¤ç®¡ç†
        clusterHandler := cluster.NewClusterHandler()
        clusterGroup := v1.Group("/clusters")
        clusterGroup.Use(middleware.Auth()) // éœ€è¦è®¤è¯
        {
            clusterGroup.POST("", clusterHandler.Create)
            clusterGroup.GET("", clusterHandler.List)
            clusterGroup.GET("/:name", clusterHandler.Get)
            clusterGroup.PUT("/:name", clusterHandler.Update)
            clusterGroup.DELETE("/:name", clusterHandler.Delete)
            clusterGroup.POST("/:name/test", clusterHandler.Test)
        }
    }
    
    return r
}
```

#### Step 4: ç¼–è¯‘æµ‹è¯•

```bash
# 1. è¿›å…¥åç«¯ç›®å½•
cd ~/k8s-manager/backend

# 2. ä¸‹è½½ä¾èµ–ï¼ˆå¦‚æœæœ‰æ–°ä¾èµ–ï¼‰
go mod tidy

# 3. ç¼–è¯‘æ£€æŸ¥
go build -o bin/test cmd/server/main.go

# 4. è¿è¡Œæµ‹è¯•
go run cmd/server/main.go

# 5. åœ¨å¦ä¸€ä¸ªç»ˆç«¯æµ‹è¯•API
curl -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

### 4.2 å‰ç«¯å¼€å‘æ ‡å‡†æµç¨‹

#### Step 1: åˆ›å»ºç»„ä»¶/é¡µé¢

```bash
# åˆ›å»ºé¡µé¢ç›®å½•
mkdir -p ~/k8s-manager/frontend/src/pages/Cluster

# åˆ›å»ºç»„ä»¶æ–‡ä»¶
touch ~/k8s-manager/frontend/src/pages/Cluster/ClusterList.tsx
touch ~/k8s-manager/frontend/src/pages/Cluster/ClusterList.css
```

#### Step 2: ç¼–å†™ä»£ç ï¼ˆè‡ªåº•å‘ä¸Šï¼‰

**1. APIæœåŠ¡** (`src/services/cluster.ts`):
```typescript
import request from '@/utils/request';

export interface Cluster {
  id: number;
  name: string;
  api_server: string;
  version: string;
  status: number;
  description: string;
  created_at: string;
}

export interface ClusterListResponse {
  total: number;
  page: number;
  page_size: number;
  items: Cluster[];
}

// è·å–é›†ç¾¤åˆ—è¡¨
export async function getClusterList(params: {
  page?: number;
  page_size?: number;
}): Promise<ClusterListResponse> {
  return request.get('/clusters', { params });
}

// åˆ›å»ºé›†ç¾¤
export async function createCluster(data: {
  name: string;
  kubeconfig: string;
  description?: string;
}): Promise<Cluster> {
  return request.post('/clusters', data);
}

// åˆ é™¤é›†ç¾¤
export async function deleteCluster(name: string): Promise<void> {
  return request.delete(`/clusters/${name}`);
}
```

**2. é¡µé¢ç»„ä»¶** (`src/pages/Cluster/ClusterList.tsx`):
```typescript
import React, { useState, useEffect } from 'react';
import { Table, Button, Space, Modal, message } from 'antd';
import { PlusOutlined, DeleteOutlined, EyeOutlined } from '@ant-design/icons';
import { getClusterList, deleteCluster, type Cluster } from '@/services/cluster';
import './ClusterList.css';

export const ClusterList: React.FC = () => {
  const [loading, setLoading] = useState(false);
  const [clusters, setClusters] = useState<Cluster[]>([]);
  const [total, setTotal] = useState(0);
  const [page, setPage] = useState(1);
  const [pageSize, setPageSize] = useState(20);

  // åŠ è½½æ•°æ®
  const loadData = async () => {
    setLoading(true);
    try {
      const res = await getClusterList({ page, page_size: pageSize });
      setClusters(res.items);
      setTotal(res.total);
    } catch (error) {
      message.error('åŠ è½½å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    loadData();
  }, [page, pageSize]);

  // åˆ é™¤é›†ç¾¤
  const handleDelete = (record: Cluster) => {
    Modal.confirm({
      title: 'ç¡®è®¤åˆ é™¤',
      content: `ç¡®å®šè¦åˆ é™¤é›†ç¾¤ "${record.name}" å—ï¼Ÿ`,
      onOk: async () => {
        try {
          await deleteCluster(record.name);
          message.success('åˆ é™¤æˆåŠŸ');
          loadData();
        } catch (error) {
          message.error('åˆ é™¤å¤±è´¥');
        }
      },
    });
  };

  const columns = [
    {
      title: 'é›†ç¾¤åç§°',
      dataIndex: 'name',
      key: 'name',
    },
    {
      title: 'API Server',
      dataIndex: 'api_server',
      key: 'api_server',
    },
    {
      title: 'ç‰ˆæœ¬',
      dataIndex: 'version',
      key: 'version',
    },
    {
      title: 'çŠ¶æ€',
      dataIndex: 'status',
      key: 'status',
      render: (status: number) => (
        <span className={`status-badge ${status === 1 ? 'success' : 'error'}`}>
          {status === 1 ? 'æ­£å¸¸' : 'å¼‚å¸¸'}
        </span>
      ),
    },
    {
      title: 'åˆ›å»ºæ—¶é—´',
      dataIndex: 'created_at',
      key: 'created_at',
    },
    {
      title: 'æ“ä½œ',
      key: 'action',
      render: (_: any, record: Cluster) => (
        <Space>
          <Button 
            type="link" 
            icon={<EyeOutlined />}
            onClick={() => {/* æŸ¥çœ‹è¯¦æƒ… */}}
          >
            è¯¦æƒ…
          </Button>
          <Button 
            type="link" 
            danger
            icon={<DeleteOutlined />}
            onClick={() => handleDelete(record)}
          >
            åˆ é™¤
          </Button>
        </Space>
      ),
    },
  ];

  return (
    <div className="cluster-list cyber-page">
      <div className="page-header">
        <h2 className="page-title">é›†ç¾¤ç®¡ç†</h2>
        <Button 
          type="primary" 
          icon={<PlusOutlined />}
          onClick={() => {/* æ‰“å¼€åˆ›å»ºå¼¹çª— */}}
        >
          æ·»åŠ é›†ç¾¤
        </Button>
      </div>

      <div className="page-content">
        <Table
          loading={loading}
          columns={columns}
          dataSource={clusters}
          rowKey="id"
          pagination={{
            total,
            current: page,
            pageSize,
            onChange: (p, ps) => {
              setPage(p);
              setPageSize(ps || 20);
            },
          }}
        />
      </div>
    </div>
  );
};
```

**3. æ ·å¼æ–‡ä»¶** (`src/pages/Cluster/ClusterList.css`):
```css
.cluster-list {
  padding: 24px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
}

.page-content {
  background: var(--bg-card);
  border-radius: 12px;
  padding: 24px;
  border: 1px solid var(--border-glow);
}

.status-badge {
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 600;
}

.status-badge.success {
  background: rgba(57, 255, 20, 0.1);
  color: var(--neon-green);
  border: 1px solid var(--neon-green);
}

.status-badge.error {
  background: rgba(255, 0, 110, 0.1);
  color: var(--neon-red);
  border: 1px solid var(--neon-red);
}
```

#### Step 3: æµ‹è¯•è¿è¡Œ

```bash
# 1. è¿›å…¥å‰ç«¯ç›®å½•
cd ~/k8s-manager/frontend

# 2. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœ‰æ–°ä¾èµ–ï¼‰
npm install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm start

# 4. åœ¨æµè§ˆå™¨æ‰“å¼€
# http://localhost:3000
```

### 4.3 é›†æˆè”è°ƒæµç¨‹

```bash
# ç»ˆç«¯1: å¯åŠ¨åç«¯
cd ~/k8s-manager/backend
go run cmd/server/main.go

# ç»ˆç«¯2: å¯åŠ¨å‰ç«¯
cd ~/k8s-manager/frontend
npm start

# ç»ˆç«¯3: æŸ¥çœ‹æµ‹è¯•ç¯å¢ƒæ—¥å¿—ï¼ˆå¦‚æœéœ€è¦ï¼‰
cd ~/k8s-manager
./test-env-logs.sh
```

**è”è°ƒæ£€æŸ¥é¡¹**:
- [ ] APIè¯·æ±‚æ˜¯å¦æˆåŠŸ
- [ ] æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
- [ ] é”™è¯¯æç¤ºæ˜¯å¦å‹å¥½
- [ ] LoadingçŠ¶æ€æ˜¯å¦æ­£å¸¸
- [ ] ç•Œé¢åˆ·æ–°æ˜¯å¦åŠæ—¶

---

## 5. ä»£ç è§„èŒƒ

### 5.1 Goä»£ç è§„èŒƒ

#### å‘½åè§„èŒƒ

```go
// âœ… å¥½çš„å‘½å
type UserService struct {}
func (s *UserService) GetUserByID(id uint) (*User, error) {}
var ErrUserNotFound = errors.New("user not found")

// âŒ ä¸å¥½çš„å‘½å
type userservice struct {}
func (s *userservice) get_user(i uint) (*User, error) {}
var err1 = errors.New("not found")
```

#### æ³¨é‡Šè§„èŒƒ

```go
// âœ… å®Œæ•´çš„æ³¨é‡Š
// UserService ç”¨æˆ·æœåŠ¡
// æä¾›ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å¤„ç†
type UserService struct {
    repo *UserRepository
}

// GetUserByID æ ¹æ®IDè·å–ç”¨æˆ·ä¿¡æ¯
// @param id ç”¨æˆ·ID
// @return ç”¨æˆ·å¯¹è±¡å’Œé”™è¯¯ä¿¡æ¯
func (s *UserService) GetUserByID(id uint) (*User, error) {
    // å‚æ•°éªŒè¯
    if id == 0 {
        return nil, ErrInvalidUserID
    }
    
    // æŸ¥è¯¢ç”¨æˆ·
    user, err := s.repo.FindByID(id)
    if err != nil {
        return nil, err
    }
    
    return user, nil
}

// âŒ ç¼ºå°‘æ³¨é‡Š
type UserService struct {
    repo *UserRepository
}

func (s *UserService) GetUserByID(id uint) (*User, error) {
    if id == 0 {
        return nil, ErrInvalidUserID
    }
    user, err := s.repo.FindByID(id)
    if err != nil {
        return nil, err
    }
    return user, nil
}
```

#### é”™è¯¯å¤„ç†è§„èŒƒ

```go
// âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
func (s *ClusterService) Create(cluster *Cluster) error {
    // 1. å‚æ•°éªŒè¯
    if cluster.Name == "" {
        return errors.New("é›†ç¾¤åç§°ä¸èƒ½ä¸ºç©º")
    }
    
    // 2. ä¸šåŠ¡é€»è¾‘
    if err := s.validateKubeconfig(cluster.Kubeconfig); err != nil {
        return fmt.Errorf("kubeconfigéªŒè¯å¤±è´¥: %w", err)
    }
    
    // 3. æ•°æ®æŒä¹…åŒ–
    if err := s.repo.Create(cluster); err != nil {
        return fmt.Errorf("ä¿å­˜é›†ç¾¤å¤±è´¥: %w", err)
    }
    
    return nil
}

// âŒ ä¸å®Œæ•´çš„é”™è¯¯å¤„ç†
func (s *ClusterService) Create(cluster *Cluster) error {
    s.validateKubeconfig(cluster.Kubeconfig)
    s.repo.Create(cluster)
    return nil
}
```

### 5.2 TypeScriptä»£ç è§„èŒƒ

#### ç±»å‹å®šä¹‰

```typescript
// âœ… å®Œæ•´çš„ç±»å‹å®šä¹‰
export interface Cluster {
  id: number;
  name: string;
  api_server: string;
  version: string;
  status: number;
  description?: string;
  created_at: string;
  updated_at: string;
}

export interface ClusterListParams {
  page?: number;
  page_size?: number;
  keyword?: string;
  status?: number;
}

// âŒ ä½¿ç”¨any
export interface Cluster {
  id: any;
  name: any;
  [key: string]: any;
}
```

#### ç»„ä»¶è§„èŒƒ

```typescript
// âœ… å®Œæ•´çš„ç»„ä»¶å®šä¹‰
import React, { useState, useEffect } from 'react';

interface ClusterCardProps {
  cluster: Cluster;
  onDelete?: (cluster: Cluster) => void;
  onUpdate?: (cluster: Cluster) => void;
}

/**
 * é›†ç¾¤å¡ç‰‡ç»„ä»¶
 * æ˜¾ç¤ºé›†ç¾¤çš„åŸºæœ¬ä¿¡æ¯å’Œæ“ä½œæŒ‰é’®
 */
export const ClusterCard: React.FC<ClusterCardProps> = ({
  cluster,
  onDelete,
  onUpdate,
}) => {
  const [loading, setLoading] = useState(false);

  const handleDelete = async () => {
    setLoading(true);
    try {
      await onDelete?.(cluster);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="cluster-card">
      {/* ç»„ä»¶å†…å®¹ */}
    </div>
  );
};

// âŒ ç¼ºå°‘ç±»å‹å’Œæ³¨é‡Š
export const ClusterCard = ({ cluster, onDelete }) => {
  return <div>{cluster.name}</div>;
};
```

### 5.3 CSS/æ ·å¼è§„èŒƒ

```css
/* âœ… å¥½çš„CSSç»„ç»‡ */
/* ==================== é›†ç¾¤å¡ç‰‡ ==================== */
.cluster-card {
  /* å¸ƒå±€ */
  position: relative;
  padding: 24px;
  
  /* å¤–è§‚ */
  background: var(--bg-card);
  border: 1px solid var(--border-glow);
  border-radius: 12px;
  
  /* åŠ¨ç”» */
  transition: all 0.3s ease;
}

.cluster-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-cyan-md);
}

.cluster-card__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.cluster-card__title {
  font-size: 18px;
  font-weight: 600;
  color: var(--neon-cyan);
}

/* âŒ æ··ä¹±çš„CSS */
.cluster-card {
  padding: 24px;
  background: var(--bg-card);
  transition: all 0.3s ease;
  border: 1px solid var(--border-glow);
  position: relative;
  border-radius: 12px;
}
.cluster-card:hover {transform: translateY(-4px);box-shadow: var(--shadow-cyan-md);}
.cluster-card__header {display: flex;justify-content: space-between;}
```

---

## 6. æµ‹è¯•æµç¨‹

### 6.1 åç«¯æµ‹è¯•æ¸…å•

#### å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰

```go
// cluster_service_test.go
package service

import (
    "testing"
    "github.com/stretchr/testify/assert"
)

func TestClusterService_Create(t *testing.T) {
    service := NewClusterService()
    
    cluster := &Cluster{
        Name:       "test-cluster",
        Kubeconfig: "...",
    }
    
    err := service.Create(cluster)
    assert.NoError(t, err)
    assert.NotZero(t, cluster.ID)
}
```

#### APIæµ‹è¯•ï¼ˆå¿…é¡»ï¼‰

```bash
#!/bin/bash
# test-api.sh - APIæµ‹è¯•è„šæœ¬

BASE_URL="http://localhost:8080/api/v1"
TOKEN=""

echo "ğŸ§ª å¼€å§‹APIæµ‹è¯•..."
echo ""

# 1. æµ‹è¯•ç™»å½•
echo "1ï¸âƒ£ æµ‹è¯•ç™»å½•..."
LOGIN_RESP=$(curl -s -X POST ${BASE_URL}/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}')

TOKEN=$(echo $LOGIN_RESP | jq -r '.data.token')

if [ "$TOKEN" = "null" ] || [ -z "$TOKEN" ]; then
    echo "âŒ ç™»å½•å¤±è´¥"
    exit 1
fi
echo "âœ… ç™»å½•æˆåŠŸ, Token: ${TOKEN:0:20}..."

# 2. æµ‹è¯•é›†ç¾¤åˆ—è¡¨
echo ""
echo "2ï¸âƒ£ æµ‹è¯•é›†ç¾¤åˆ—è¡¨..."
LIST_RESP=$(curl -s -X GET ${BASE_URL}/clusters \
  -H "Authorization: Bearer ${TOKEN}")

echo $LIST_RESP | jq '.'

if echo $LIST_RESP | jq -e '.code == 0' > /dev/null; then
    echo "âœ… é›†ç¾¤åˆ—è¡¨è·å–æˆåŠŸ"
else
    echo "âŒ é›†ç¾¤åˆ—è¡¨è·å–å¤±è´¥"
    exit 1
fi

# 3. æµ‹è¯•åˆ›å»ºé›†ç¾¤
echo ""
echo "3ï¸âƒ£ æµ‹è¯•åˆ›å»ºé›†ç¾¤..."
CREATE_RESP=$(curl -s -X POST ${BASE_URL}/clusters \
  -H "Authorization: Bearer ${TOKEN}" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "test-cluster-'$(date +%s)'",
    "kubeconfig": "apiVersion: v1...",
    "description": "æµ‹è¯•é›†ç¾¤"
  }')

echo $CREATE_RESP | jq '.'

if echo $CREATE_RESP | jq -e '.code == 0' > /dev/null; then
    echo "âœ… åˆ›å»ºé›†ç¾¤æˆåŠŸ"
else
    echo "âŒ åˆ›å»ºé›†ç¾¤å¤±è´¥"
fi

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… APIæµ‹è¯•å®Œæˆ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

### 6.2 å‰ç«¯æµ‹è¯•æ¸…å•

#### åŠŸèƒ½æµ‹è¯•

- [ ] é¡µé¢èƒ½æ­£å¸¸åŠ è½½
- [ ] æ•°æ®èƒ½æ­£ç¡®æ˜¾ç¤º
- [ ] æŒ‰é’®ç‚¹å‡»æœ‰å“åº”
- [ ] è¡¨å•èƒ½æ­£ç¡®æäº¤
- [ ] é”™è¯¯èƒ½æ­£ç¡®æç¤º
- [ ] LoadingçŠ¶æ€æ­£å¸¸
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸

#### äº¤äº’æµ‹è¯•

- [ ] æ‚¬åœæ•ˆæœæ­£å¸¸
- [ ] ç‚¹å‡»åŠ¨ç”»æµç•…
- [ ] æ¨¡æ€æ¡†èƒ½æ‰“å¼€å…³é—­
- [ ] è¡¨å•éªŒè¯æ­£ç¡®
- [ ] åˆ é™¤ç¡®è®¤æ­£å¸¸

#### å…¼å®¹æ€§æµ‹è¯•

- [ ] Chromeæµè§ˆå™¨æ­£å¸¸
- [ ] Firefoxæµè§ˆå™¨æ­£å¸¸
- [ ] ä¸åŒåˆ†è¾¨ç‡æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯å“åº”å¼æ­£å¸¸ï¼ˆå¦‚æœéœ€è¦ï¼‰

### 6.3 é›†æˆæµ‹è¯•

```bash
#!/bin/bash
# integration-test.sh - é›†æˆæµ‹è¯•è„šæœ¬

echo "ğŸ§ª å¼€å§‹é›†æˆæµ‹è¯•..."
echo ""

# 1. æ£€æŸ¥åç«¯
echo "1ï¸âƒ£ æ£€æŸ¥åç«¯æœåŠ¡..."
if ! curl -s http://localhost:8080/health > /dev/null; then
    echo "âŒ åç«¯æœåŠ¡æœªå¯åŠ¨"
    exit 1
fi
echo "âœ… åç«¯æœåŠ¡æ­£å¸¸"

# 2. æ£€æŸ¥å‰ç«¯
echo ""
echo "2ï¸âƒ£ æ£€æŸ¥å‰ç«¯æœåŠ¡..."
if ! curl -s http://localhost:3000 > /dev/null; then
    echo "âŒ å‰ç«¯æœåŠ¡æœªå¯åŠ¨"
    exit 1
fi
echo "âœ… å‰ç«¯æœåŠ¡æ­£å¸¸"

# 3. æ£€æŸ¥æ•°æ®åº“
echo ""
echo "3ï¸âƒ£ æ£€æŸ¥æ•°æ®åº“è¿æ¥..."
if ! docker exec k8s-mgr-mysql-test mysql -uroot -ptest123456 -e "SELECT 1" > /dev/null 2>&1; then
    echo "âŒ æ•°æ®åº“è¿æ¥å¤±è´¥"
    exit 1
fi
echo "âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸"

# 4. æ‰§è¡Œç«¯åˆ°ç«¯æµ‹è¯•
echo ""
echo "4ï¸âƒ£ æ‰§è¡Œç«¯åˆ°ç«¯æµ‹è¯•..."

# 4.1 ç™»å½•
TOKEN=$(curl -s -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}' \
  | jq -r '.data.token')

if [ "$TOKEN" = "null" ]; then
    echo "âŒ ç™»å½•å¤±è´¥"
    exit 1
fi
echo "  âœ“ ç™»å½•æˆåŠŸ"

# 4.2 è·å–é›†ç¾¤åˆ—è¡¨
CLUSTERS=$(curl -s -X GET http://localhost:8080/api/v1/clusters \
  -H "Authorization: Bearer ${TOKEN}" \
  | jq -r '.data.total')

echo "  âœ“ è·å–é›†ç¾¤åˆ—è¡¨æˆåŠŸ (å…± ${CLUSTERS} ä¸ªé›†ç¾¤)"

# 4.3 åˆ›å»ºæµ‹è¯•æ•°æ®
echo "  âœ“ åˆ›å»ºæµ‹è¯•æ•°æ®..."

# 4.4 æ¸…ç†æµ‹è¯•æ•°æ®
echo "  âœ“ æ¸…ç†æµ‹è¯•æ•°æ®..."

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… é›†æˆæµ‹è¯•é€šè¿‡"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

---

## 7. æäº¤è§„èŒƒ

### 7.1 Gitæäº¤è§„èŒƒ

#### Commit Messageæ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Typeç±»å‹**:
- `feat`: æ–°åŠŸèƒ½
- `fix`: Bugä¿®å¤
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œï¼‰
- `refactor`: é‡æ„
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

**ScopeèŒƒå›´**:
- `cluster`: é›†ç¾¤ç®¡ç†
- `deployment`: Deploymentç®¡ç†
- `pod`: Podç®¡ç†
- `service`: Serviceç®¡ç†
- `auth`: è®¤è¯æˆæƒ
- `ui`: å‰ç«¯ç•Œé¢
- `api`: APIæ¥å£

**ç¤ºä¾‹**:

```bash
# å¥½çš„commit message
git commit -m "feat(cluster): æ·»åŠ é›†ç¾¤åˆ—è¡¨æŸ¥è¯¢åŠŸèƒ½

- å®ç°é›†ç¾¤åˆ—è¡¨API
- æ”¯æŒåˆ†é¡µå’Œç­›é€‰
- æ·»åŠ é›†ç¾¤çŠ¶æ€æ˜¾ç¤º

Closes #123"

git commit -m "fix(deployment): ä¿®å¤æ‰©ç¼©å®¹å‰¯æœ¬æ•°éªŒè¯é—®é¢˜

å‰¯æœ¬æ•°åº”è¯¥å¤§äº0ï¼Œä¹‹å‰å…è®¸è®¾ç½®ä¸º0å¯¼è‡´é”™è¯¯

Fixes #456"

git commit -m "docs: æ›´æ–°APIæ–‡æ¡£

æ·»åŠ é›†ç¾¤ç®¡ç†ç›¸å…³æ¥å£æ–‡æ¡£"

# ä¸å¥½çš„commit message
git commit -m "update"
git commit -m "fix bug"
git commit -m "add feature"
```

### 7.2 ä»£ç æäº¤æ£€æŸ¥æ¸…å•

**æäº¤å‰å¿…é¡»æ£€æŸ¥**:

```bash
#!/bin/bash
# pre-commit-check.sh - æäº¤å‰æ£€æŸ¥

echo "ğŸ“‹ æäº¤å‰æ£€æŸ¥..."
echo ""

# 1. ä»£ç æ ¼å¼æ£€æŸ¥
echo "1ï¸âƒ£ æ£€æŸ¥ä»£ç æ ¼å¼..."
if command -v gofmt &> /dev/null; then
    UNFORMATTED=$(gofmt -l .)
    if [ -n "$UNFORMATTED" ]; then
        echo "âŒ ä»¥ä¸‹æ–‡ä»¶éœ€è¦æ ¼å¼åŒ–:"
        echo "$UNFORMATTED"
        exit 1
    fi
    echo "âœ… ä»£ç æ ¼å¼æ­£ç¡®"
fi

# 2. è¯­æ³•æ£€æŸ¥
echo ""
echo "2ï¸âƒ£ æ£€æŸ¥è¯­æ³•é”™è¯¯..."
if ! go build ./... > /dev/null 2>&1; then
    echo "âŒ ç¼–è¯‘å¤±è´¥ï¼Œè¯·ä¿®å¤é”™è¯¯"
    exit 1
fi
echo "âœ… ç¼–è¯‘é€šè¿‡"

# 3. æµ‹è¯•æ£€æŸ¥
echo ""
echo "3ï¸âƒ£ è¿è¡Œæµ‹è¯•..."
if ! go test ./... > /dev/null 2>&1; then
    echo "âŒ æµ‹è¯•å¤±è´¥"
    exit 1
fi
echo "âœ… æµ‹è¯•é€šè¿‡"

# 4. æ£€æŸ¥TODO
echo ""
echo "4ï¸âƒ£ æ£€æŸ¥TODO..."
TODO_COUNT=$(git diff --cached | grep -c "TODO")
if [ "$TODO_COUNT" -gt 0 ]; then
    echo "âš ï¸  å‘ç° ${TODO_COUNT} ä¸ªTODOï¼Œè¯·ç¡®è®¤æ˜¯å¦éœ€è¦å¤„ç†"
fi

echo ""
echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œå¯ä»¥æäº¤"
```

---

## 8. é—®é¢˜å¤„ç†

### 8.1 å¸¸è§é—®é¢˜è¯Šæ–­

#### é—®é¢˜1: åç«¯ç¼–è¯‘å¤±è´¥

**ç—‡çŠ¶**:
```
go build: cannot find module providing package xxx
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥ä¾èµ–
go mod tidy

# 2. ä¸‹è½½ä¾èµ–
go mod download

# 3. æ¸…ç†ç¼“å­˜
go clean -modcache
```

#### é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**:
```
Error: dial tcp 127.0.0.1:13306: connect: connection refused
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps | grep mysql

# 2. æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 13306

# 3. é‡å¯å®¹å™¨
docker restart k8s-mgr-mysql-test

# 4. æµ‹è¯•è¿æ¥
docker exec -it k8s-mgr-mysql-test mysql -uroot -ptest123456
```

#### é—®é¢˜3: K8S APIè°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**:
```
Error: Unauthorized
Error: the server has asked for the client to provide credentials
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥kubeconfig
kubectl --kubeconfig=/path/to/config get nodes

# 2. æ£€æŸ¥æƒé™
kubectl --kubeconfig=/path/to/config auth can-i get pods

# 3. æ£€æŸ¥è¯ä¹¦
openssl x509 -in /path/to/cert -text -noout
```

#### é—®é¢˜4: å‰ç«¯æ— æ³•è®¿é—®åç«¯

**ç—‡çŠ¶**:
```
CORS policy: No 'Access-Control-Allow-Origin' header
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥åç«¯CORSé…ç½®
# æŸ¥çœ‹ internal/middleware/cors.go

# 2. æ£€æŸ¥å‰ç«¯ä»£ç†é…ç½®
# æŸ¥çœ‹ vite.config.ts æˆ– package.json

# 3. ä½¿ç”¨curlæµ‹è¯•
curl -H "Origin: http://localhost:3000" \
  -H "Access-Control-Request-Method: POST" \
  -X OPTIONS \
  http://localhost:8080/api/v1/clusters
```

### 8.2 è°ƒè¯•æŠ€å·§

#### åç«¯è°ƒè¯•

```go
// ä½¿ç”¨logæ‰“å°
log.Printf("Debug: cluster name = %s", cluster.Name)

// ä½¿ç”¨fmtæ‰“å°
fmt.Printf("Debug: %+v\n", cluster)

// ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼ˆVSCodeï¼‰
// åœ¨ .vscode/launch.json ä¸­é…ç½®
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Launch",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/cmd/server",
      "env": {},
      "args": []
    }
  ]
}
```

#### å‰ç«¯è°ƒè¯•

```typescript
// ä½¿ç”¨console.log
console.log('Debug:', cluster);

// ä½¿ç”¨debuggeræ–­ç‚¹
function handleDelete(cluster: Cluster) {
  debugger; // æµè§ˆå™¨ä¼šåœ¨è¿™é‡Œæš‚åœ
  // ...
}

// ä½¿ç”¨React DevTools
// å®‰è£…æµè§ˆå™¨æ’ä»¶: React Developer Tools
```

#### ç½‘ç»œè°ƒè¯•

```bash
# æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
curl -v http://localhost:8080/api/v1/clusters

# ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
# F12 -> Network -> æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…

# ä½¿ç”¨Postman
# åˆ›å»ºCollection -> ä¿å­˜å¸¸ç”¨è¯·æ±‚
```

---

## 9. æœ€ä½³å®è·µ

### 9.1 Codexå·¥ä½œæœ€ä½³å®è·µ

#### å®è·µ1: åˆ†æ­¥éª¤å¼€å‘

```
âŒ ä¸å¥½çš„æ–¹å¼:
ç”¨æˆ·: "å®ç°æ•´ä¸ªDeploymentç®¡ç†åŠŸèƒ½"
Codex: [ä¸€æ¬¡æ€§å†™å®Œæ‰€æœ‰ä»£ç ]

âœ… å¥½çš„æ–¹å¼:
ç”¨æˆ·: "å®ç°Deploymentç®¡ç†åŠŸèƒ½"
Codex: "æˆ‘å»ºè®®åˆ†3æ­¥å®Œæˆ:
  ç¬¬1æ­¥: å®ç°åˆ—è¡¨æŸ¥è¯¢å’Œè¯¦æƒ…æŸ¥çœ‹
  ç¬¬2æ­¥: å®ç°åˆ›å»ºå’Œæ›´æ–°
  ç¬¬3æ­¥: å®ç°åˆ é™¤ã€æ‰©ç¼©å®¹å’Œé‡å¯
  
  ç°åœ¨å¼€å§‹ç¬¬1æ­¥ï¼Œå…ˆå®ç°åˆ—è¡¨æŸ¥è¯¢ï¼Ÿ"
```

#### å®è·µ2: å…ˆéªŒè¯åå®ç°

```
âŒ ä¸å¥½çš„æ–¹å¼:
Codex: [ç›´æ¥å†™ä»£ç ]

âœ… å¥½çš„æ–¹å¼:
Codex: "å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘å…ˆéªŒè¯ä¸€ä¸‹:
  1. æ£€æŸ¥ç¯å¢ƒ: âœ“ Dockerè¿è¡Œä¸­
  2. æ£€æŸ¥ä¾èµ–: âœ“ client-goå·²å®‰è£…
  3. æµ‹è¯•è¿æ¥: âœ“ æ•°æ®åº“è¿æ¥æ­£å¸¸
  
  ç¯å¢ƒæ­£å¸¸ï¼Œå¼€å§‹ç¼–å†™ä»£ç ..."
```

#### å®è·µ3: è¾¹å†™è¾¹æµ‹

```
âŒ ä¸å¥½çš„æ–¹å¼:
Codex: [å†™å®Œæ‰€æœ‰ä»£ç ] "ä»£ç å·²å®Œæˆ"

âœ… å¥½çš„æ–¹å¼:
Codex: [å†™ä¸€éƒ¨åˆ†ä»£ç ]
  "æˆ‘å·²ç»å®Œæˆäº†æ•°æ®æ¨¡å‹å’ŒServiceå±‚ï¼Œ
   è®©æˆ‘å…ˆæµ‹è¯•ä¸€ä¸‹ç¼–è¯‘æ˜¯å¦é€šè¿‡..."
   
   [æ‰§è¡Œ go build]
   "âœ“ ç¼–è¯‘é€šè¿‡ï¼Œç»§ç»­å®ç°APIå±‚..."
   
   [å†™APIä»£ç ]
   "APIå±‚å®Œæˆï¼Œæµ‹è¯•ä¸€ä¸‹..."
   
   [æ‰§è¡Œcurlæµ‹è¯•]
   "âœ“ APIæµ‹è¯•é€šè¿‡ï¼ŒåŠŸèƒ½å®Œæˆ"
```

#### å®è·µ4: ä¸»åŠ¨å‘ç°é—®é¢˜

```
Codexå‘ç°é—®é¢˜:
"âš ï¸ æ³¨æ„: æˆ‘å‘ç°äº†ä¸€ä¸ªæ½œåœ¨é—®é¢˜:
  
  å½“å‰ä»£ç åœ¨é«˜å¹¶å‘æ—¶å¯èƒ½å­˜åœ¨ç«æ€æ¡ä»¶ï¼Œ
  å› ä¸ºClusterManageræ²¡æœ‰åŠ é”ä¿æŠ¤ã€‚
  
  å»ºè®®ä¿®æ”¹ä¸º:
  [æä¾›æ”¹è¿›æ–¹æ¡ˆ]
  
  æ˜¯å¦éœ€è¦ä¿®å¤ï¼Ÿ"
```

### 9.2 ä»£ç è´¨é‡æœ€ä½³å®è·µ

#### å®è·µ1: å•ä¸€èŒè´£

```go
// âœ… å¥½çš„è®¾è®¡ - èŒè´£å•ä¸€
type ClusterService struct {
    repo *ClusterRepository
}

func (s *ClusterService) Create(cluster *Cluster) error {
    // åªè´Ÿè´£ä¸šåŠ¡é€»è¾‘
}

type ClusterRepository struct {
    db *gorm.DB
}

func (r *ClusterRepository) Create(cluster *Cluster) error {
    // åªè´Ÿè´£æ•°æ®è®¿é—®
}

// âŒ ä¸å¥½çš„è®¾è®¡ - èŒè´£æ··ä¹±
type ClusterService struct {
    db *gorm.DB
}

func (s *ClusterService) Create(cluster *Cluster) error {
    // æ—¢æœ‰ä¸šåŠ¡é€»è¾‘åˆæœ‰æ•°æ®è®¿é—®
    return s.db.Create(cluster).Error
}
```

#### å®è·µ2: ä¾èµ–æ³¨å…¥

```go
// âœ… å¥½çš„è®¾è®¡ - ä¾èµ–æ³¨å…¥
type ClusterHandler struct {
    service *ClusterService
}

func NewClusterHandler(service *ClusterService) *ClusterHandler {
    return &ClusterHandler{
        service: service,
    }
}

// âŒ ä¸å¥½çš„è®¾è®¡ - ç¡¬ç¼–ç ä¾èµ–
type ClusterHandler struct {}

func (h *ClusterHandler) Create(c *gin.Context) {
    service := NewClusterService() // æ¯æ¬¡éƒ½åˆ›å»ºæ–°å®ä¾‹
    // ...
}
```

#### å®è·µ3: é”™è¯¯å¤„ç†

```go
// âœ… å¥½çš„é”™è¯¯å¤„ç†
func (s *ClusterService) GetByName(name string) (*Cluster, error) {
    cluster, err := s.repo.FindByName(name)
    if err != nil {
        if errors.Is(err, gorm.ErrRecordNotFound) {
            return nil, ErrClusterNotFound
        }
        return nil, fmt.Errorf("æŸ¥è¯¢é›†ç¾¤å¤±è´¥: %w", err)
    }
    return cluster, nil
}

// âŒ ä¸å¥½çš„é”™è¯¯å¤„ç†
func (s *ClusterService) GetByName(name string) (*Cluster, error) {
    cluster, err := s.repo.FindByName(name)
    if err != nil {
        return nil, err // ä¸¢å¤±äº†é”™è¯¯ä¸Šä¸‹æ–‡
    }
    return cluster, nil
}
```

### 9.3 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ

#### å®è·µ1: æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

```go
// âœ… å¥½çš„æŸ¥è¯¢ - åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
func (r *ClusterRepository) List() ([]Cluster, error) {
    var clusters []Cluster
    err := r.db.Select("id, name, api_server, version, status, created_at").
        Find(&clusters).Error
    return clusters, err
}

// âŒ ä¸å¥½çš„æŸ¥è¯¢ - æŸ¥è¯¢æ‰€æœ‰å­—æ®µ
func (r *ClusterRepository) List() ([]Cluster, error) {
    var clusters []Cluster
    err := r.db.Find(&clusters).Error // kubeconfigä¹Ÿä¼šè¢«æŸ¥è¯¢
    return clusters, err
}
```

#### å®è·µ2: ç¼“å­˜ä½¿ç”¨

```go
// âœ… ä½¿ç”¨ç¼“å­˜
func (s *ClusterService) GetByName(name string) (*Cluster, error) {
    // 1. å…ˆæŸ¥ç¼“å­˜
    if cached := cache.Get("cluster:" + name); cached != nil {
        return cached.(*Cluster), nil
    }
    
    // 2. æŸ¥æ•°æ®åº“
    cluster, err := s.repo.FindByName(name)
    if err != nil {
        return nil, err
    }
    
    // 3. å†™å…¥ç¼“å­˜
    cache.Set("cluster:"+name, cluster, 5*time.Minute)
    
    return cluster, nil
}
```

#### å®è·µ3: å¹¶å‘æ§åˆ¶

```go
// âœ… ä½¿ç”¨sync.Mapä¿è¯å¹¶å‘å®‰å…¨
type ClusterManager struct {
    clients sync.Map
    mu      sync.RWMutex
}

// âŒ ä¸å®‰å…¨çš„å¹¶å‘
type ClusterManager struct {
    clients map[string]*kubernetes.Clientset // å¹¶å‘è¯»å†™ä¼španic
}
```

---

## 10. æ£€æŸ¥æ¸…å•

### 10.1 å¼€å‘å®Œæˆæ£€æŸ¥æ¸…å•

**æ¯ä¸ªåŠŸèƒ½å¼€å‘å®Œæˆåï¼ŒCodexåº”è¯¥æ£€æŸ¥**:

```markdown
## åŠŸèƒ½å®Œæˆæ£€æŸ¥æ¸…å•

### ä»£ç è´¨é‡
- [ ] ä»£ç å·²æ ¼å¼åŒ–ï¼ˆgofmt/prettierï¼‰
- [ ] æ²¡æœ‰è¯­æ³•é”™è¯¯
- [ ] æ²¡æœ‰æ˜æ˜¾çš„é€»è¾‘é”™è¯¯
- [ ] å˜é‡å‘½åæ¸…æ™°
- [ ] å‡½æ•°èŒè´£å•ä¸€
- [ ] æœ‰å¿…è¦çš„æ³¨é‡Š

### åŠŸèƒ½å®Œæ•´æ€§
- [ ] åç«¯APIå·²å®ç°
- [ ] å‰ç«¯é¡µé¢å·²å®ç°
- [ ] å‰åç«¯å·²è”è°ƒ
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] è¾¹ç•Œæƒ…å†µå·²è€ƒè™‘

### æµ‹è¯•éªŒè¯
- [ ] ç¼–è¯‘é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] APIæµ‹è¯•é€šè¿‡
- [ ] å‰ç«¯åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡

### æ–‡æ¡£å®Œå–„
- [ ] APIæ–‡æ¡£å·²æ›´æ–°
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´
- [ ] ä½¿ç”¨è¯´æ˜æ¸…æ™°

### æ€§èƒ½å®‰å…¨
- [ ] æ²¡æœ‰SQLæ³¨å…¥é£é™©
- [ ] æ²¡æœ‰XSSé£é™©
- [ ] æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†
- [ ] æŸ¥è¯¢å·²ä¼˜åŒ–
- [ ] æ²¡æœ‰å†…å­˜æ³„æ¼

### ç”¨æˆ·ä½“éªŒ
- [ ] åŠ è½½çŠ¶æ€æ˜¾ç¤º
- [ ] é”™è¯¯æç¤ºå‹å¥½
- [ ] æ“ä½œåé¦ˆåŠæ—¶
- [ ] ç•Œé¢å“åº”æµç•…

### ä»£ç æäº¤
- [ ] Commit messageè§„èŒƒ
- [ ] ä»£ç å·²æ¨é€
- [ ] æ–‡æ¡£å·²åŒæ­¥

### äº¤ä»˜ç”¨æˆ·
- [ ] ä»£ç å·²æ•´ç†
- [ ] æ–‡æ¡£å·²ç¼–å†™
- [ ] éƒ¨ç½²è¯´æ˜æ¸…æ™°
```

### 10.2 æ—¥å¸¸å¼€å‘æ£€æŸ¥æ¸…å•

**æ¯å¤©å¼€å§‹å¼€å‘å‰**:
- [ ] æ‰§è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
- [ ] æ‹‰å–æœ€æ–°ä»£ç 
- [ ] å¯åŠ¨æµ‹è¯•ç¯å¢ƒ
- [ ] æŸ¥çœ‹å¾…åŠäº‹é¡¹

**æ¯å¤©ç»“æŸå¼€å‘å**:
- [ ] æäº¤ä»£ç 
- [ ] åœæ­¢æµ‹è¯•ç¯å¢ƒï¼ˆå¯é€‰ï¼‰
- [ ] è®°å½•å¼€å‘æ—¥å¿—
- [ ] æ›´æ–°å¾…åŠäº‹é¡¹

---

## é™„å½•

### A. å¿«æ·å‘½ä»¤

```bash
# ~/.bashrc æˆ– ~/.zshrc
alias k8s-dev-start="cd ~/k8s-manager && ./test-env-start.sh"
alias k8s-dev-stop="cd ~/k8s-manager && ./test-env-stop.sh"
alias k8s-dev-reset="cd ~/k8s-manager && ./test-env-reset.sh"
alias k8s-dev-logs="cd ~/k8s-manager && ./test-env-logs.sh"
alias k8s-dev-check="cd ~/k8s-manager && ./check-env.sh"

alias k8s-backend="cd ~/k8s-manager/backend && go run cmd/server/main.go"
alias k8s-frontend="cd ~/k8s-manager/frontend && npm start"

alias k8s-test-api="cd ~/k8s-manager && ./test-api.sh"
alias k8s-mysql="docker exec -it k8s-mgr-mysql-test mysql -uroot -ptest123456 k8s_manager_test"
```

### B. å¸¸ç”¨ä»£ç ç‰‡æ®µ

**Goé”™è¯¯å®šä¹‰**:
```go
// pkg/errors/errors.go
package errors

import "errors"

var (
    ErrInvalidParams    = errors.New("å‚æ•°é”™è¯¯")
    ErrUnauthorized     = errors.New("æœªæˆæƒ")
    ErrForbidden        = errors.New("ç¦æ­¢è®¿é—®")
    ErrNotFound         = errors.New("èµ„æºä¸å­˜åœ¨")
    ErrInternalServer   = errors.New("æœåŠ¡å™¨å†…éƒ¨é”™è¯¯")
    ErrDatabaseError    = errors.New("æ•°æ®åº“é”™è¯¯")
    ErrK8SAPIError      = errors.New("K8S APIè°ƒç”¨å¤±è´¥")
)
```

**ç»Ÿä¸€å“åº”**:
```go
// pkg/response/response.go
package response

import (
    "net/http"
    "github.com/gin-gonic/gin"
)

type Response struct {
    Code    int         `json:"code"`
    Message string      `json:"message"`
    Data    interface{} `json:"data,omitempty"`
}

func Success(c *gin.Context, data interface{}) {
    c.JSON(http.StatusOK, Response{
        Code:    0,
        Message: "success",
        Data:    data,
    })
}

func Error(c *gin.Context, code int, message string) {
    c.JSON(http.StatusOK, Response{
        Code:    code,
        Message: message,
    })
}

func ErrorWithData(c *gin.Context, code int, message string, data interface{}) {
    c.JSON(http.StatusOK, Response{
        Code:    code,
        Message: message,
        Data:    data,
    })
}
```

### C. å¼€å‘æ—¥å¿—æ¨¡æ¿

```markdown
# å¼€å‘æ—¥å¿—

## 2025-11-11

### å®Œæˆçš„åŠŸèƒ½
- [x] å®ç°é›†ç¾¤åˆ—è¡¨æŸ¥è¯¢API
- [x] å®ç°é›†ç¾¤åˆ›å»ºAPI
- [x] å‰ç«¯é›†ç¾¤åˆ—è¡¨é¡µé¢

### é‡åˆ°çš„é—®é¢˜
1. é—®é¢˜: kubeconfigè§£æå¤±è´¥
   è§£å†³: ä½¿ç”¨clientcmd.RESTConfigFromKubeConfigæ–¹æ³•

2. é—®é¢˜: æ•°æ®åº“è¿æ¥è¶…æ—¶
   è§£å†³: å¢åŠ è¿æ¥è¶…æ—¶æ—¶é—´é…ç½®

### æ˜å¤©è®¡åˆ’
- [ ] å®ç°é›†ç¾¤åˆ é™¤åŠŸèƒ½
- [ ] å®ç°é›†ç¾¤è¿æ¥æµ‹è¯•
- [ ] ä¼˜åŒ–é”™è¯¯æç¤º

### å·¥ä½œæ—¶é•¿
- åç«¯å¼€å‘: 3å°æ—¶
- å‰ç«¯å¼€å‘: 2å°æ—¶
- è°ƒè¯•æµ‹è¯•: 1å°æ—¶
- æ€»è®¡: 6å°æ—¶
```

---

## æ€»ç»“

è¿™ä»½å·¥ä½œæµè§„èŒƒæ¶µç›–äº†ï¼š

1. âœ… **å®Œæ•´çš„å¼€å‘æµç¨‹** - ä»éœ€æ±‚åˆ°äº¤ä»˜
2. âœ… **ç¯å¢ƒå‡†å¤‡æ£€æŸ¥** - è‡ªåŠ¨åŒ–è„šæœ¬
3. âœ… **ä»£ç è§„èŒƒè¦æ±‚** - Go/TS/CSS
4. âœ… **æµ‹è¯•æµç¨‹æ¸…å•** - å•å…ƒ/é›†æˆ/E2E
5. âœ… **æäº¤è§„èŒƒæ¨¡æ¿** - Git Commit
6. âœ… **é—®é¢˜è¯Šæ–­æ–¹æ³•** - å¸¸è§é—®é¢˜è§£å†³
7. âœ… **æœ€ä½³å®è·µæŒ‡å—** - ä»£ç è´¨é‡/æ€§èƒ½
8. âœ… **å®Œæ•´æ£€æŸ¥æ¸…å•** - åŠŸèƒ½å®ŒæˆéªŒè¯

**æ ¸å¿ƒåŸåˆ™**:
- ğŸ¯ **æ˜ç¡®ç›®æ ‡** - æ¯æ¬¡å¼€å‘å‰ç¡®è®¤éœ€æ±‚
- ğŸ”„ **å°æ­¥å¿«è·‘** - åˆ†æ­¥éª¤å¼€å‘ï¼Œè¾¹å†™è¾¹æµ‹
- âœ… **è´¨é‡ä¼˜å…ˆ** - ä»£ç è´¨é‡æ¯”é€Ÿåº¦æ›´é‡è¦
- ğŸ“ **æ–‡æ¡£åŒæ­¥** - ä»£ç å’Œæ–‡æ¡£åŒæ­¥æ›´æ–°
- ğŸ§ª **å……åˆ†æµ‹è¯•** - ä¸æµ‹è¯•ä¸æäº¤

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-11  
**é€‚ç”¨å¯¹è±¡**: Codex + Jason  
**é¡¹ç›®**: K8Sé›†ç¾¤ç®¡ç†å¹³å°
